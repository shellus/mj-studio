# 生图功能介绍

MJ-Studio 支持多种主流 AI 绘图模型，提供统一的创作界面和强大的参数定制能力。

## 功能概述

生图功能允许你通过文字描述生成图片，支持参考图垫图、模型专属参数调节、AI 提示词优化等高级功能。所有任务支持实时状态跟踪、历史记录查看和一键复用。

### 核心能力

- **多模型支持**：Midjourney、DALL-E、Flux、Gemini、豆包等主流模型
- **参考图垫图**：上传参考图引导生成（部分模型）
- **参数定制**：根据模型类型提供专属参数控件
- **AI 优化**：一键优化提示词，自动生成负面提示词
- **任务管理**：实时状态同步、历史任务复用、回收站恢复

## 支持的模型

### Midjourney

**特点**：
- 艺术风格丰富，擅长超现实和艺术化效果
- 支持 U/V 按钮操作（放大单图、生成变体）
- 支持 MJ 和 NIJI 两种机器人类型

**支持的参数**：
- 负面提示词

**使用场景**：概念设计、艺术创作、风格化插图

---

### DALL-E 3

**特点**：
- OpenAI 官方模型，生成质量稳定
- 擅长理解复杂提示词
- 支持高清模式

**支持的参数**：
- 尺寸：1024x1024（方形）、1792x1024（横版）、1024x1792（竖版）
- 质量：标准、高清
- 风格：生动（超现实）、自然

**使用场景**：营销素材、社交媒体配图、通用图像生成

---

### Flux

**特点**：
- 开源模型，生成速度快
- 支持灵活的宽高比配置
- 支持负面提示词精细控制

**支持的参数**：
- 宽高比：1:1、16:9、9:16、4:3、3:4、3:2、2:3、21:9
- 负面提示词

**使用场景**：快速原型、批量生成、自定义尺寸需求

---

### 豆包绘图

**特点**：
- 字节跳动模型，支持中文提示词
- 丰富的尺寸选项和参数控制
- 支持水印开关

**支持的参数**：
- 尺寸：1024x1024、1152x864、864x1152、1280x720、720x1280、1248x832、832x1248
- 提示词相关度：1-10（值越大与提示词相关性越强）
- 随机种子：固定种子可复现结果（-1 为自动）
- 负面提示词
- 水印：右下角"AI生成"水印开关

**使用场景**：中文创作、精细参数调节、可控的随机性

---

### GPT-4o 图像生成

**特点**：
- 基于 GPT-4o 的图像生成能力
- 支持背景透明度控制
- 质量分级细致

**支持的参数**：
- 尺寸：自动、1024x1024、1536x1024、1024x1536
- 质量：高、中、低
- 背景：自动、透明、不透明

**使用场景**：需要透明背景的 Logo/图标、UI 素材

---

### Gemini 绘图

**特点**：
- Google 的多模态模型
- 响应速度快
- 理解能力强

**支持的参数**：无额外参数

**使用场景**：快速生成、概念验证

---

### 其他模型

- **GPT Image**：OpenAI 图像系列模型
- **Sora 图像**：Sora 的图像生成能力
- **Grok 图像**：xAI 的图像生成模型
- **通义万相**：阿里巴巴的图像生成服务
- **Z-Image**：Gitee AI 图像生成
- **抠抠图**：智能背景移除服务

## 使用方式

### 基础流程

1. **选择模型**
   - 在"选择模型"下拉框中选择上游配置和 AI 模型
   - 点击右侧信息图标可查看模型详情（API 格式、模型名称）

2. **上传参考图**（可选）
   - 支持 JPG、PNG 格式，单张最大 10MB
   - 最多上传 3 张参考图
   - 点击图片可预览，悬停显示删除按钮
   - **注意**：部分模型不支持参考图（如 DALL-E）

3. **输入提示词**
   - 在文本框中描述你想要的图片
   - 支持多行输入，建议详细描述（风格、元素、场景等）
   - 可使用"AI 优化"按钮自动优化提示词（需在设置中配置优化模型）

4. **配置高级选项**（可选）
   - 点击"高级选项"展开参数面板
   - 根据选择的模型，系统会自动显示支持的参数
   - 参数数量会显示在"高级选项"旁边（如 +5）

5. **开始生成**
   - 点击"开始生成"按钮提交任务
   - 任务会添加到任务列表，实时显示状态和进度

### AI 提示词优化

点击提示词输入框旁的"AI 优化"按钮，系统会：

1. 自动优化提示词结构和用词
2. 根据目标模型特性调整表达方式
3. 为支持负面提示词的模型生成负面提示词（如 Flux、豆包）

**配置优化模型**：
- 前往"设置 > 绘图 > AI 优化"
- 选择用于优化的上游配置和模型
- 建议使用 GPT-4o 或 Claude 等理解能力强的模型

### 高级选项说明

高级选项根据选择的模型动态显示，常见参数包括：

#### 尺寸（Size）

适用模型：DALL-E、豆包、GPT-4o 图像

- 预设常用尺寸（如 1024x1024、1792x1024）
- 不同模型支持的尺寸选项不同

#### 宽高比（Aspect Ratio）

适用模型：Flux

- 支持 1:1、16:9、9:16、4:3、3:4、3:2、2:3、21:9
- 适合创作不同场景的图片（社交媒体、海报、封面等）

#### 质量（Quality）

适用模型：DALL-E、GPT-4o 图像

- **DALL-E**：标准、高清
- **GPT-4o**：高、中、低

#### 风格（Style）

适用模型：DALL-E 3

- **生动**：更加超现实和戏剧化
- **自然**：更加写实和自然

#### 负面提示词（Negative Prompt）

适用模型：Flux、豆包、Z-Image

- 描述不希望出现的内容（如"模糊、低质量、变形、水印"）
- 可通过 AI 优化自动生成

#### 随机种子（Seed）

适用模型：豆包

- 固定种子可复现相同结果（相同提示词 + 种子 = 相同图片）
- 设为 -1 则每次随机生成
- 取值范围：-1 到 2147483647

#### 提示词相关度（Guidance Scale）

适用模型：豆包

- 控制生成结果与提示词的贴合程度
- 取值范围：1-10
- 值越大，越严格遵循提示词

#### 水印（Watermark）

适用模型：豆包

- 开启后在图片右下角添加"AI生成"水印
- 默认开启

#### 背景（Background）

适用模型：GPT-4o 图像

- **自动**：模型自动决定
- **透明**：生成透明背景（适合 Logo/图标）
- **不透明**：强制不透明背景

## 任务管理

### 任务状态

- **等待提交**（pending）：任务已创建，等待系统处理
- **提交中**（submitting）：正在提交到上游 API
- **处理中**（processing）：上游正在生成图片
- **成功**（success）：生成完成
- **失败**（failed）：生成失败，可查看错误日志
- **已取消**（cancelled）：用户主动取消

### 任务操作

#### 查看详情

点击任务卡片可查看：
- 完整提示词
- 模型参数
- 上游配置信息
- 生成时间
- 图片预览（成功时）

#### 查看日志

点击"查看日志"按钮可查看：
- 请求参数（URL、Headers、Body）
- 响应内容（状态码、响应体、错误信息）
- 敏感信息已自动脱敏（API Key、Base64 图片）

#### 重试任务

失败的任务可点击"重试"按钮重新提交（使用相同参数）

#### 取消任务

处理中的任务可点击"取消"按钮中止（同步模型支持，异步模型需等待上游完成）

#### 复用参数

点击任务卡片的"复用"按钮，可将该任务的提示词、参考图和模型参数填充到创作面板，快速创作变体

#### Midjourney 按钮操作

Midjourney 生成的图片会显示 U1-U4、V1-V4、🔄 等按钮：
- **U（Upscale）**：放大单张图片
- **V（Variation）**：生成变体
- **🔄（Reroll）**：重新生成

### 筛选和搜索

**来源筛选**：
- 工作台：从创作工作台创建的任务
- 对话：从对话窗口创建的任务（嵌入式绘图）
- 全部：显示所有任务

**任务类型筛选**：
- 图片：图片生成任务
- 视频：视频生成任务
- 全部：显示所有类型

**关键词搜索**：
- 搜索提示词内容
- 搜索任务唯一标识符（uniqueId）

### 回收站

删除的任务会进入回收站，支持：
- **恢复**：将任务恢复到任务列表
- **永久删除**：物理删除单个任务
- **清空回收站**：物理删除所有回收站任务

## 模型选择建议

| 需求场景 | 推荐模型 | 理由 |
|---------|---------|-----|
| 艺术创作、概念设计 | Midjourney | 风格化强、支持 U/V 操作 |
| 营销素材、通用配图 | DALL-E 3 | 质量稳定、理解能力强 |
| 快速原型、批量生成 | Flux | 速度快、宽高比灵活 |
| 中文创作、精细调节 | 豆包 | 参数丰富、支持中文 |
| 透明背景素材 | GPT-4o 图像 | 支持背景透明度控制 |
| 快速验证 | Gemini | 响应快、成本低 |

## 注意事项

1. **参考图兼容性**：
   - DALL-E、Z-Image 不支持参考图
   - 其他模型支持 1-3 张参考图

2. **尺寸限制**：
   - 参考图单张最大 10MB
   - 不同模型支持的输出尺寸不同

3. **提示词建议**：
   - 英文提示词通常效果更好（除豆包等国产模型）
   - 详细描述风格、场景、元素、构图等要素
   - 避免过于抽象或矛盾的描述

4. **成本优化**：
   - 使用预计时间长的模型时，建议先小规模测试
   - 利用 AI 优化功能提高成功率，减少重试次数

5. **任务同步**：
   - 所有任务支持多端同步（同一账号的不同浏览器标签页/设备）
   - 任务状态通过 SSE 实时推送，无需手动刷新

6. **对话生图**：
   - 支持在对话中使用 Gemini 等模型直接生成图片
   - 生成的图片自动保存到本地，支持连续编辑
   - 使用公网 URL 引用图片，避免 base64 导致 token 超限
   - 详见 [对话功能介绍 - 对话生图与连续编辑](./对话功能介绍.md#对话生图与连续编辑)
